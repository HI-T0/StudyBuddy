<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern Study Planner</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body>
    <div class="container">
        <h1 class="title">StudyBuddy</h1>
        <div id="dashboard" class="dashboard">
            <!-- Dashboard widgets will be dynamically added here -->
        </div>
        <div class="tabs">
            <div class="tabs-list">
                <button class="tab-trigger active" data-tab="calendar">
                    <i data-lucide="calendar"></i>
                    Calendar
                </button>
                <button class="tab-trigger" data-tab="todo">
                    <i data-lucide="check-square"></i>
                    To-Do
                </button>
                <button class="tab-trigger" data-tab="pomodoro">
                    <i data-lucide="clock"></i>
                    Pomodoro
                </button>
                <button class="tab-trigger pro-feature" data-tab="flashcards">
                    <i data-lucide="book-open"></i>
                    Flashcards
                </button>
                <button class="tab-trigger" data-tab="notes">
                    <i data-lucide="file-text"></i>
                    Notes
                </button>
                <button class="tab-trigger pro-feature" data-tab="groups">
                    <i data-lucide="users"></i>
                    Study Groups
                </button>
                <button class="tab-trigger pro-feature" data-tab="resources">
                    <i data-lucide="library"></i>
                    Resources
                </button>
                <button class="tab-trigger pro-feature" data-tab="progress">
                    <i data-lucide="trending-up"></i>
                    Progress
                </button>
                <button class="tab-trigger pro-feature" data-tab="quiz">
                    <i data-lucide="help-circle"></i>
                    Quiz
                </button>
                <button class="tab-trigger" data-tab="forum">
                    <i data-lucide="message-square"></i>
                    Forum
                </button>
                <button class="tab-trigger" data-tab="goals">
                    <i data-lucide="target"></i>
                    Goals
                </button>
            </div>
            <div class="tab-content active" id="calendar">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Study Calendar</h2>
                    </div>
                    <div class="card-content">
                        <div class="calendar-header">
                            <button id="prev-month">Previous</button>
                            <h2 id="current-month"></h2>
                            <button id="next-month">Next</button>
                        </div>
                        <div id="calendar-grid"></div>
                        <form id="assignment-form" class="hidden">
                            <input name="title" placeholder="Assignment Title" required>
                            <input name="subject" placeholder="Subject" required>
                            <input name="estimatedEffort" type="number" placeholder="Estimated Effort (hours)" required>
                            <button type="submit">Add Assignment</button>
                        </form>
                    </div>
                </div>
            </div>
            <div class="tab-content" id="todo">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">To-Do List</h2>
                    </div>
                    <div class="card-content">
                        <form id="todo-form">
                            <input type="text" id="todo-input" placeholder="New task" required>
                            <input type="date" id="todo-date" required>
                            <button type="submit">Add Task</button>
                        </form>
                        <ul id="todo-list"></ul>
                    </div>
                </div>
            </div>
            <div class="tab-content" id="pomodoro">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Pomodoro Timer</h2>
                    </div>
                    <div class="card-content">
                        <div id="timer" class="timer">25:00</div>
                        <div class="button-group">
                            <button id="start-timer">Start</button>
                            <button id="reset-timer">Reset</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="tab-content pro-feature" id="flashcards">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Flashcards (Pro Feature)</h2>
                    </div>
                    <div class="card-content">
                        <p class="pro-notice">Upgrade to a pro account to access this feature!</p>
                        <div class="feature-content">
                            <div id="flashcard-container" class="flashcard-container">
                                <div class="flashcard">
                                    <div class="flashcard-inner">
                                        <div class="flashcard-front">
                                            <p>Front of the card</p>
                                        </div>
                                        <div class="flashcard-back">
                                            <p>Back of the card</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="button-group">
                                <button id="prev-card">Previous</button>
                                <button id="flip-card">Flip</button>
                                <button id="next-card">Next</button>
                            </div>
                            <form id="add-flashcard-form">
                                <input name="cardFront" placeholder="Front of card" required>
                                <input name="cardBack" placeholder="Back of card" required>
                                <button type="submit">Add Flashcard</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <div class="tab-content" id="notes">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Notes</h2>
                    </div>
                    <div class="card-content">
                        <select id="note-subject">
                            <option value="">Select Subject</option>
                            <option value="math">Math</option>
                            <option value="science">Science</option>
                            <option value="history">History</option>
                            <option value="literature">Literature</option>
                        </select>
                        <textarea id="note-content" placeholder="Write your notes here..."></textarea>
                        <button id="save-note">Save Note</button>
                        <div id="notes-list"></div>
                    </div>
                </div>
            </div>
            <div class="tab-content pro-feature" id="groups">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Study Groups (Pro Feature)</h2>
                    </div>
                    <div class="card-content">
                        <p class="pro-notice">Upgrade to a pro account to access this feature!</p>
                        <div class="feature-content">
                            <form id="create-group-form">
                                <input type="text" id="group-name" placeholder="Group Name" required>
                                <input type="text" id="group-subject" placeholder="Subject" required>
                                <button type="submit">Create Group</button>
                            </form>
                            <div id="groups-list"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="tab-content pro-feature" id="resources">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Resource Library (Pro Feature)</h2>
                    </div>
                    <div class="card-content">
                        <p class="pro-notice">Upgrade to a pro account to access this feature!</p>
                        <div class="feature-content">
                            <form id="add-resource-form">
                                <input type="text" id="resource-title" placeholder="Resource Title" required>
                                <input type="url" id="resource-url" placeholder="Resource URL" required>
                                <select id="resource-type">
                                    <option value="article">Article</option>
                                    <option value="video">Video</option>
                                    <option value="book">Book</option>
                                </select>
                                <button type="submit">Add Resource</button>
                            </form>
                            <div id="resources-list"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="tab-content pro-feature" id="progress">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Progress Tracker (Pro Feature)</h2>
                    </div>
                    <div class="card-content">
                        <p class="pro-notice">Upgrade to a pro account to access this feature!</p>
                        <div class="feature-content">
                            <canvas id="progress-chart"></canvas>
                            <div id="progress-stats"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="tab-content pro-feature" id="quiz">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Quiz (Pro Feature)</h2>
                    </div>
                    <div class="card-content">
                        <p class="pro-notice">Upgrade to a pro account to access this feature!</p>
                        <div class="feature-content">
                            <div id="quiz-container">
                                <div id="question-container"></div>
                                <div id="answer-buttons" class="btn-grid"></div>
                                <button id="start-btn" class="start-btn btn">Start Quiz</button>
                                <button id="next-btn" class="next-btn btn hide">Next</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="tab-content" id="forum">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Discussion Forum</h2>
                    </div>
                    <div class="card-content">
                        <form id="forum-post-form">
                            <input type="text" id="post-title" placeholder="Post Title" required>
                            <textarea id="post-content" placeholder="Write your post here..." required></textarea>
                            <button type="submit">Submit Post</button>
                        </form>
                        <div id="forum-posts"></div>
                    </div>
                </div>
            </div>
            <div class="tab-content" id="goals">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Goal Setting</h2>
                    </div>
                    <div class="card-content">
                        <form id="goal-form">
                            <input type="text" id="goal-title" placeholder="Goal Title" required>
                            <input type="date" id="goal-deadline" required>
                            <textarea id="goal-description" placeholder="Goal Description" required></textarea>
                            <button type="submit">Set Goal</button>
                        </form>
                        <div id="goals-list"></div>
                    </div>
                </div>
            </div>
        </div>
        <div id="upgrade-container" class="upgrade-container">
            <a href="{{ url_for('upgrade_page') }}" class="upgrade-button">Upgrade to Pro</a>
        </div>
    </div>
    <div id="daily-tip" class="daily-tip">
        <p id="tip-content"></p>
    </div>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="module" src="{{ url_for('static', filename='js/main.js') }}"></script>
    <script>
        async function checkAccountType() {
            try {
                const response = await fetch('/get_account_type');
                const data = await response.json();
                if (!data.is_pro) {
                    document.querySelectorAll('.pro-feature').forEach(el => {
                        el.classList.add('locked');
                        el.querySelector('.pro-notice').style.display = 'block';
                        el.querySelectorAll('.feature-content').forEach(hiddenEl => {
                            hiddenEl.style.display = 'none';
                        });
                    });
                    document.getElementById('upgrade-container').style.display = 'block';
                } else {
                    document.querySelectorAll('.pro-feature').forEach(el => {
                        el.classList.remove('locked');
                        el.querySelector('.pro-notice').style.display = 'none';
                        el.querySelectorAll('.feature-content').forEach(hiddenEl => {
                            hiddenEl.style.display = 'block';
                        });
                    });
                    document.getElementById('upgrade-container').style.display = 'none';
                }
            } catch (error) {
                console.error('Error fetching account type:', error);
            }
        }

        document.addEventListener('DOMContentLoaded', checkAccountType);
    </script>
</body>
</html>